<%- include("templates/headerAfter", {dropdown: true, page: "/" , isTaskPage: false}) %>

    <link rel="stylesheet" type="text/css" href="/styles/Calendar.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.18.1/moment.min.js"></script>
    <script src='https://cdn.jsdelivr.net/npm/fullcalendar@6.1.13/index.global.min.js'></script>
    <script src="scripts/calendar.js"></script>
    <script>
        // // listen to the top navbar dropdown menu and show project name on it
        // const projectListDiv = document.getElementById('projectListDropdown');
        // projectListDiv.addEventListener('change', function (event) {
        //     if (event.target.matches('input[name="listGroupRadios"]')) {
        //         const selectedProjectId = event.target.value;
        //         const url = new URL(window.location.href);
        //         url.searchParams.set('projectId', selectedProjectId);
        //         history.pushState(null, '', url);
        //         console.log(url);

        //         // Fetch project name and update navbar brand
        //         fetch(`/getProjectName?projectId=${selectedProjectId}`)
        //             .then(response => {
        //                 if (!response.ok) {
        //                     throw new Error('Network response was not ok');
        //                 }
        //                 return response.json();
        //             })
        //             .then(project => {
        //                 const navbarBrand = document.getElementById('navbarDropdown');
        //                 if (project && project.projectName) {
        //                     navbarBrand.textContent = project.projectName;
        //                 } else {
        //                     throw new Error('Project data not found');
        //                 }
        //             })
        //             .catch(error => {
        //                 console.error('Error fetching project data:', error);
        //             });

        //         // Fetch tasks and update calendar
        //         console.log(selectedProjectId);
        //         fetchAndShowTasksData(selectedProjectId);

        //     };
        // });

        // document.addEventListener('DOMContentLoaded', function () {
        //     // task form pop up after clicking the plus button on task page
        //     var addTaskButton = document.getElementById('add-task-btn');
        //     var taskForm = document.getElementById('task-form');
        //     var cancelBtn = document.getElementById('taskform-close-btn');
        //     var hiddenProjectIdInput = document.getElementById('taskform-project-id');
        //     var addMemberModal = document.getElementById('add-member-modal');
        //     var memberListDiv = document.getElementById('taskform-member-list');

        //     addTaskButton.addEventListener('click', function () {
        //         // Show the task form
        //         taskForm.classList.add('show');

        //         // Get the projectId from the URL query parameters
        //         var urlParams = new URLSearchParams(window.location.search);
        //         var projectId = urlParams.get('projectId');

        //         // Set the projectId as the value of the hidden input field
        //         hiddenProjectIdInput.value = projectId;
        //     });

        //     cancelBtn.addEventListener('click', function () {
        //         // Hide the task form
        //         taskForm.classList.remove('show');
        //         // Hide the add-member-modal
        //         addMemberModal.classList.remove('show');
        //         addMemberModal.style.display = 'none';
        //         // Clear the member list div
        //         memberListDiv.innerHTML = '';
        //     });

        //     // Calendar functions
        //     var calendarEl = document.getElementById('calendar');
        //     var calendar = new FullCalendar.Calendar(calendarEl, {
        //         initialView: 'dayGridMonth',
        //         editable: true,
        //         headerToolbar: { // buttons for switching between views
        //             left: 'dayGridMonth,timeGridWeek',
        //             center: 'title',
        //             right: 'today prev,next'
        //         },
        //         views: {
        //             dayGridMonth: { // name of view
        //                 titleFormat: { year: 'numeric', month: 'long' }
        //                 // other view-specific options here
        //             }
        //         },

        //         select: function (start, end, jsEvent, view) {
        //             console.log('select', start, end, jsEvent, view);
        //         },

        //         dateClick: function (info) {
        //             alert('Date: ' + info.dateStr);
        //         }
        //     });
        //     calendar.render();

        //     //For removing tasks/events
        //     calendar.on('eventClick', function (info) {
        //         var event = calendar.getEventById(info.event.id);
        //         var myModal = new bootstrap.Modal(document.getElementById("deleteDivTask"));
        //         myModal.show();
        //         console.log(info.event.id);
        //         $('#confirmDeleteTask').on('click', function (e) {
        //             e.preventDefault();
        //             event.remove();
        //         });
        //     });

        //     //For adding new tasks/events
        //     $('#submitTask').on('click', function (e) {
        //         e.preventDefault();
        //         submit();
        //     });

        //     // function submit() {
        //     //     //Settings variables of new task
        //     //     startDate = $('#start-date').val()
        //     //     startTime = $('#start-time').val()
        //     //     dueDate = $('#due-date').val()
        //     //     dueTime = $('#due-time').val()
        //     //     title = $('#title').val()

        //     //     console.log(startDate);
        //     //     console.log(startTime);
        //     //     console.log(dueDate);
        //     //     console.log(dueTime);
        //     //     console.log(title);
        //     //     //Concating date and time
        //     //     var start = moment(`${startDate}T${startTime}`).format('YYYY-MM-DDTHH:mm');
        //     //     var end = moment(`${dueDate}T${dueTime}`).format('YYYY-MM-DDTHH:mm');
        //     //     console.log(start);
        //     //     console.log(end);
        //     //     //Adding new task/event onto the calendar
        //     //     calendar.addEvent({
        //     //         id: title,
        //     //         title: title,
        //     //         start: start,
        //     //         end: end,
        //     //         allDay: false
        //     //     })
        //     // }

        // });

    </script>

    <div id="calendar">
    </div>

    <div class="add-task">
        <button class="add-btn" id="add-task-btn">+</button>
    </div>

    <!-- Hidden form -->
    <div class="task-form" id="task-form">
        <%- include("taskForm") %>
    </div>

    <!-- Delete Modal -->
    <div class="modal fade" id="deleteDivTask" tabindex="-1" aria-labelledby="deleteTask" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h1 class="modal-title fs-5" id="deleteTask">Delete Task?</h1>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="submit" class="btn btn-primary" id="confirmDeleteTask"
                        data-bs-dismiss="modal">Delete</button>
                </div>
            </div>
        </div>
    </div>

    <%- include("templates/footerAfter", {footer: true, dropdown: true, isTaskPage: false}) %>